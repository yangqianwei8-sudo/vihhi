# å›æ¬¾ç®¡ç†æ¨¡å—å¼€å‘æ–¹æ¡ˆ

## ä¸€ã€æ¨¡å—æ¦‚è¿°

### 1.1 ä¸šåŠ¡èƒŒæ™¯
å›æ¬¾ç®¡ç†æ˜¯è´¢åŠ¡ç®¡ç†ä¸­çš„é‡è¦ç¯èŠ‚ï¼Œç”¨äºè®°å½•å’Œç®¡ç†é¡¹ç›®å®é™…æ”¶åˆ°çš„æ¬¾é¡¹ï¼Œä¸é¡¹ç›®ä¸­å¿ƒçš„å›æ¬¾è®¡åˆ’ï¼ˆPaymentPlanï¼‰ç›¸äº’å…³è”ï¼Œå®ç°å¯¹é¡¹ç›®å›æ¬¾å…¨ç”Ÿå‘½å‘¨æœŸçš„è·Ÿè¸ªå’Œç®¡ç†ã€‚

### 1.2 æ¨¡å—å®šä½
- **æ‰€å±æ¨¡å—**ï¼šè´¢åŠ¡ç®¡ç†æ¨¡å—ï¼ˆ`financial_management`ï¼‰
- **è®¿é—®è·¯å¾„**ï¼š`/financial/payments/`
- **èœå•ä½ç½®**ï¼šé¦–é¡µå·¦ä¾§èœå•"ğŸ’³ å›æ¬¾ç®¡ç†"

### 1.3 æ ¸å¿ƒåŠŸèƒ½
1. **å›æ¬¾è®°å½•ç®¡ç†**ï¼šåˆ›å»ºã€ç¼–è¾‘ã€æŸ¥çœ‹ã€åˆ é™¤å›æ¬¾è®°å½•
2. **å›æ¬¾è®¡åˆ’å…³è”**ï¼šå…³è”é¡¹ç›®ä¸­å¿ƒçš„å›æ¬¾è®¡åˆ’ï¼Œè‡ªåŠ¨æ›´æ–°è®¡åˆ’çŠ¶æ€
3. **å‘ç¥¨å…³è”**ï¼šå…³è”å·²å¼€å…·çš„å‘ç¥¨
4. **çŠ¶æ€è·Ÿè¸ª**ï¼šè·Ÿè¸ªå›æ¬¾çŠ¶æ€ï¼ˆå¾…å›æ¬¾ã€éƒ¨åˆ†å›æ¬¾ã€å·²å®Œæˆã€å·²é€¾æœŸç­‰ï¼‰
5. **ç»Ÿè®¡åˆ†æ**ï¼šå›æ¬¾ç»Ÿè®¡ã€å›æ¬¾è¶‹åŠ¿åˆ†æã€å›æ¬¾å®Œæˆç‡ç­‰

---

## äºŒã€æ•°æ®æ¨¡å‹è®¾è®¡

### 2.1 Paymentï¼ˆå›æ¬¾è®°å½•ï¼‰æ¨¡å‹

```python
class Payment(models.Model):
    """å›æ¬¾è®°å½•"""
    
    STATUS_CHOICES = [
        ('pending', 'å¾…å›æ¬¾'),
        ('partial', 'éƒ¨åˆ†å›æ¬¾'),
        ('completed', 'å·²å®Œæˆ'),
        ('overdue', 'å·²é€¾æœŸ'),
        ('cancelled', 'å·²å–æ¶ˆ'),
    ]
    
    PAYMENT_METHOD_CHOICES = [
        ('bank_transfer', 'é“¶è¡Œè½¬è´¦'),
        ('cash', 'ç°é‡‘'),
        ('check', 'æ”¯ç¥¨'),
        ('acceptance', 'æ‰¿å…‘æ±‡ç¥¨'),
        ('other', 'å…¶ä»–'),
    ]
    
    # åŸºæœ¬ä¿¡æ¯
    payment_number = models.CharField(max_length=100, unique=True, verbose_name='å›æ¬¾å•å·')
    project = models.ForeignKey('project_center.Project', on_delete=models.PROTECT, related_name='payments', verbose_name='å…³è”é¡¹ç›®')
    payment_plan = models.ForeignKey('project_center.PaymentPlan', on_delete=models.SET_NULL, null=True, blank=True, related_name='actual_payments', verbose_name='å…³è”å›æ¬¾è®¡åˆ’')
    
    # å›æ¬¾ä¿¡æ¯
    payment_date = models.DateField(verbose_name='å›æ¬¾æ—¥æœŸ')
    planned_amount = models.DecimalField(max_digits=15, decimal_places=2, verbose_name='è®¡åˆ’é‡‘é¢')
    actual_amount = models.DecimalField(max_digits=15, decimal_places=2, verbose_name='å®é™…å›æ¬¾é‡‘é¢')
    received_amount = models.DecimalField(max_digits=15, decimal_places=2, default=Decimal('0.00'), verbose_name='å·²å›æ¬¾é‡‘é¢')
    
    # çŠ¶æ€ä¿¡æ¯
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='pending', verbose_name='å›æ¬¾çŠ¶æ€')
    
    # æ”¯ä»˜ä¿¡æ¯
    payment_method = models.CharField(max_length=20, choices=PAYMENT_METHOD_CHOICES, verbose_name='æ”¯ä»˜æ–¹å¼')
    payer_name = models.CharField(max_length=200, verbose_name='ä»˜æ¬¾æ–¹åç§°')
    payer_account = models.CharField(max_length=100, blank=True, verbose_name='ä»˜æ¬¾æ–¹è´¦æˆ·')
    payee_account = models.CharField(max_length=100, verbose_name='æ”¶æ¬¾æ–¹è´¦æˆ·')
    bank_name = models.CharField(max_length=200, blank=True, verbose_name='å¼€æˆ·é“¶è¡Œ')
    
    # å…³è”ä¿¡æ¯
    invoice = models.ForeignKey(Invoice, on_delete=models.SET_NULL, null=True, blank=True, related_name='payments', verbose_name='å…³è”å‘ç¥¨')
    voucher = models.ForeignKey(Voucher, on_delete=models.SET_NULL, null=True, blank=True, related_name='payments', verbose_name='å…³è”å‡­è¯')
    
    # é™„ä»¶å’Œå¤‡æ³¨
    attachment = models.FileField(upload_to='payments/%Y/%m/', blank=True, null=True, verbose_name='å›æ¬¾å‡­è¯é™„ä»¶')
    notes = models.TextField(blank=True, verbose_name='å¤‡æ³¨è¯´æ˜')
    
    # å®¡è®¡å­—æ®µ
    created_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True, related_name='created_payments', verbose_name='åˆ›å»ºäºº')
    verified_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True, blank=True, related_name='verified_payments', verbose_name='å®¡æ ¸äºº')
    verified_time = models.DateTimeField(null=True, blank=True, verbose_name='å®¡æ ¸æ—¶é—´')
    created_time = models.DateTimeField(default=timezone.now, verbose_name='åˆ›å»ºæ—¶é—´')
    updated_time = models.DateTimeField(auto_now=True, verbose_name='æ›´æ–°æ—¶é—´')
```

### 2.2 å­—æ®µè¯´æ˜

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å¿…å¡« |
|--------|------|------|------|
| payment_number | CharField(100) | å›æ¬¾å•å·ï¼Œè‡ªåŠ¨ç”Ÿæˆæ ¼å¼ï¼šPAY-YYYY-NNNN | æ˜¯ |
| project | ForeignKey | å…³è”é¡¹ç›® | æ˜¯ |
| payment_plan | ForeignKey | å…³è”å›æ¬¾è®¡åˆ’ï¼ˆå¯é€‰ï¼‰ | å¦ |
| payment_date | DateField | å›æ¬¾æ—¥æœŸ | æ˜¯ |
| planned_amount | DecimalField | è®¡åˆ’é‡‘é¢ | æ˜¯ |
| actual_amount | DecimalField | å®é™…å›æ¬¾é‡‘é¢ | æ˜¯ |
| received_amount | DecimalField | å·²å›æ¬¾é‡‘é¢ï¼ˆç´¯è®¡ï¼‰ | å¦ |
| status | CharField | å›æ¬¾çŠ¶æ€ | æ˜¯ |
| payment_method | CharField | æ”¯ä»˜æ–¹å¼ | æ˜¯ |
| payer_name | CharField(200) | ä»˜æ¬¾æ–¹åç§° | æ˜¯ |
| payer_account | CharField(100) | ä»˜æ¬¾æ–¹è´¦æˆ· | å¦ |
| payee_account | CharField(100) | æ”¶æ¬¾æ–¹è´¦æˆ· | æ˜¯ |
| bank_name | CharField(200) | å¼€æˆ·é“¶è¡Œ | å¦ |
| invoice | ForeignKey | å…³è”å‘ç¥¨ï¼ˆå¯é€‰ï¼‰ | å¦ |
| voucher | ForeignKey | å…³è”å‡­è¯ï¼ˆå¯é€‰ï¼‰ | å¦ |
| attachment | FileField | å›æ¬¾å‡­è¯é™„ä»¶ | å¦ |
| notes | TextField | å¤‡æ³¨è¯´æ˜ | å¦ |

### 2.3 ä¸šåŠ¡è§„åˆ™

1. **å›æ¬¾å•å·è‡ªåŠ¨ç”Ÿæˆ**ï¼šæ ¼å¼ä¸º `PAY-YYYY-NNNN`ï¼ˆå¦‚ï¼šPAY-2025-0001ï¼‰
2. **çŠ¶æ€è‡ªåŠ¨æ›´æ–°**ï¼š
   - å½“ `received_amount < planned_amount` æ—¶ï¼ŒçŠ¶æ€ä¸º `partial`ï¼ˆéƒ¨åˆ†å›æ¬¾ï¼‰
   - å½“ `received_amount >= planned_amount` æ—¶ï¼ŒçŠ¶æ€ä¸º `completed`ï¼ˆå·²å®Œæˆï¼‰
   - å½“ `payment_date < today` ä¸”çŠ¶æ€ä¸º `pending` æ—¶ï¼ŒçŠ¶æ€ä¸º `overdue`ï¼ˆå·²é€¾æœŸï¼‰
3. **å…³è”å›æ¬¾è®¡åˆ’**ï¼šå¦‚æœå…³è”äº†å›æ¬¾è®¡åˆ’ï¼Œéœ€è¦è‡ªåŠ¨æ›´æ–°è®¡åˆ’çš„ `actual_amount` å’Œ `actual_date`
4. **å…³è”å‘ç¥¨**ï¼šå¯ä»¥ä¸å‘ç¥¨å…³è”ï¼Œæ–¹ä¾¿è¿½è¸ªå‘ç¥¨å¯¹åº”çš„å›æ¬¾æƒ…å†µ

---

## ä¸‰ã€åŠŸèƒ½æ¨¡å—è®¾è®¡

### 3.1 åˆ—è¡¨é¡µåŠŸèƒ½ï¼ˆpayment_list.htmlï¼‰

#### 3.1.1 åŠŸèƒ½éœ€æ±‚
- æ˜¾ç¤ºå›æ¬¾è®°å½•åˆ—è¡¨
- æ”¯æŒåˆ†é¡µï¼ˆæ¯é¡µ20æ¡ï¼‰
- æ”¯æŒç­›é€‰ï¼ˆé¡¹ç›®ã€çŠ¶æ€ã€å›æ¬¾æ—¥æœŸèŒƒå›´ã€ä»˜æ¬¾æ–¹ï¼‰
- æ”¯æŒæœç´¢ï¼ˆå›æ¬¾å•å·ã€é¡¹ç›®åç§°ã€ä»˜æ¬¾æ–¹åç§°ï¼‰
- æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼ˆæ€»å›æ¬¾é‡‘é¢ã€æœ¬æœˆå›æ¬¾ã€å¾…å›æ¬¾é‡‘é¢ç­‰ï¼‰

#### 3.1.2 åˆ—è¡¨æ˜¾ç¤ºå­—æ®µ
- å›æ¬¾å•å·
- å…³è”é¡¹ç›®
- ä»˜æ¬¾æ–¹åç§°
- è®¡åˆ’é‡‘é¢
- å®é™…å›æ¬¾é‡‘é¢
- å›æ¬¾æ—¥æœŸ
- çŠ¶æ€ï¼ˆå¸¦é¢œè‰²æ ‡è¯†ï¼‰
- æ“ä½œæŒ‰é’®ï¼ˆæŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰

#### 3.1.3 ç»Ÿè®¡å¡ç‰‡
- **æ€»å›æ¬¾é‡‘é¢**ï¼šæ‰€æœ‰å·²å®Œæˆçš„å›æ¬¾é‡‘é¢åˆè®¡
- **æœ¬æœˆå›æ¬¾**ï¼šæœ¬æœˆå®é™…å›æ¬¾é‡‘é¢åˆè®¡
- **å¾…å›æ¬¾é‡‘é¢**ï¼šçŠ¶æ€ä¸ºå¾…å›æ¬¾æˆ–éƒ¨åˆ†å›æ¬¾çš„æ€»é‡‘é¢
- **å›æ¬¾å®Œæˆç‡**ï¼šå·²å®Œæˆå›æ¬¾é‡‘é¢ / è®¡åˆ’å›æ¬¾é‡‘é¢

### 3.2 è¯¦æƒ…é¡µåŠŸèƒ½ï¼ˆpayment_detail.htmlï¼‰

#### 3.2.1 åŠŸèƒ½éœ€æ±‚
- æ˜¾ç¤ºå›æ¬¾è®°å½•çš„å®Œæ•´ä¿¡æ¯
- æ˜¾ç¤ºå…³è”é¡¹ç›®çš„åŸºæœ¬ä¿¡æ¯
- æ˜¾ç¤ºå…³è”å›æ¬¾è®¡åˆ’çš„è¯¦æƒ…
- æ˜¾ç¤ºå…³è”å‘ç¥¨çš„ä¿¡æ¯
- æ˜¾ç¤ºå®¡æ ¸æµç¨‹ï¼ˆåˆ›å»ºäººã€å®¡æ ¸äººã€å®¡æ ¸æ—¶é—´ï¼‰
- æä¾›ç¼–è¾‘ã€åˆ é™¤ã€å®¡æ ¸ç­‰æ“ä½œæŒ‰é’®

#### 3.2.2 ä¿¡æ¯åˆ†ç»„
- **åŸºæœ¬ä¿¡æ¯**ï¼šå›æ¬¾å•å·ã€å…³è”é¡¹ç›®ã€å›æ¬¾æ—¥æœŸã€çŠ¶æ€
- **é‡‘é¢ä¿¡æ¯**ï¼šè®¡åˆ’é‡‘é¢ã€å®é™…å›æ¬¾é‡‘é¢ã€å·²å›æ¬¾é‡‘é¢
- **æ”¯ä»˜ä¿¡æ¯**ï¼šæ”¯ä»˜æ–¹å¼ã€ä»˜æ¬¾æ–¹ä¿¡æ¯ã€æ”¶æ¬¾æ–¹è´¦æˆ·ã€å¼€æˆ·é“¶è¡Œ
- **å…³è”ä¿¡æ¯**ï¼šå…³è”å›æ¬¾è®¡åˆ’ã€å…³è”å‘ç¥¨ã€å…³è”å‡­è¯
- **é™„ä»¶ä¿¡æ¯**ï¼šå›æ¬¾å‡­è¯é™„ä»¶
- **å¤‡æ³¨ä¿¡æ¯**ï¼šå¤‡æ³¨è¯´æ˜

### 3.3 åˆ›å»º/ç¼–è¾‘è¡¨å•ï¼ˆpayment_form.htmlï¼‰

#### 3.3.1 è¡¨å•å­—æ®µåˆ†ç»„

**åŸºæœ¬ä¿¡æ¯**
- å…³è”é¡¹ç›®ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼Œå¿…å¡«ï¼‰
- å…³è”å›æ¬¾è®¡åˆ’ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼Œå¯é€‰ï¼Œæ ¹æ®é¡¹ç›®åŠ¨æ€åŠ è½½ï¼‰
- å›æ¬¾æ—¥æœŸï¼ˆæ—¥æœŸé€‰æ‹©å™¨ï¼Œå¿…å¡«ï¼‰
- çŠ¶æ€ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼Œé»˜è®¤"å¾…å›æ¬¾"ï¼‰

**é‡‘é¢ä¿¡æ¯**
- è®¡åˆ’é‡‘é¢ï¼ˆæ•°å­—è¾“å…¥ï¼Œå¿…å¡«ï¼Œå¦‚æœå…³è”äº†å›æ¬¾è®¡åˆ’å¯è‡ªåŠ¨å¡«å……ï¼‰
- å®é™…å›æ¬¾é‡‘é¢ï¼ˆæ•°å­—è¾“å…¥ï¼Œå¿…å¡«ï¼‰
- å·²å›æ¬¾é‡‘é¢ï¼ˆåªè¯»ï¼Œè‡ªåŠ¨è®¡ç®—ï¼‰

**æ”¯ä»˜ä¿¡æ¯**
- æ”¯ä»˜æ–¹å¼ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼Œå¿…å¡«ï¼‰
- ä»˜æ¬¾æ–¹åç§°ï¼ˆæ–‡æœ¬è¾“å…¥ï¼Œå¿…å¡«ï¼‰
- ä»˜æ¬¾æ–¹è´¦æˆ·ï¼ˆæ–‡æœ¬è¾“å…¥ï¼Œå¯é€‰ï¼‰
- æ”¶æ¬¾æ–¹è´¦æˆ·ï¼ˆæ–‡æœ¬è¾“å…¥ï¼Œå¿…å¡«ï¼‰
- å¼€æˆ·é“¶è¡Œï¼ˆæ–‡æœ¬è¾“å…¥ï¼Œå¯é€‰ï¼‰

**å…³è”ä¿¡æ¯**
- å…³è”å‘ç¥¨ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼Œå¯é€‰ï¼Œæ˜¾ç¤ºæœªå…³è”å›æ¬¾çš„å‘ç¥¨ï¼‰
- å…³è”å‡­è¯ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼Œå¯é€‰ï¼Œæ˜¾ç¤ºå·²è¿‡è´¦çš„å‡­è¯ï¼‰

**å…¶ä»–ä¿¡æ¯**
- å›æ¬¾å‡­è¯é™„ä»¶ï¼ˆæ–‡ä»¶ä¸Šä¼ ï¼Œå¯é€‰ï¼‰
- å¤‡æ³¨è¯´æ˜ï¼ˆå¤šè¡Œæ–‡æœ¬ï¼Œå¯é€‰ï¼‰

#### 3.3.2 è¡¨å•éªŒè¯
- å®é™…å›æ¬¾é‡‘é¢å¿…é¡»å¤§äº0
- å›æ¬¾æ—¥æœŸä¸èƒ½è¶…è¿‡ä»Šå¤©
- å¦‚æœå…³è”äº†å›æ¬¾è®¡åˆ’ï¼Œå®é™…å›æ¬¾é‡‘é¢ä¸èƒ½è¶…è¿‡è®¡åˆ’çš„å‰©ä½™é‡‘é¢

### 3.4 ç»Ÿè®¡æŠ¥è¡¨åŠŸèƒ½ï¼ˆpayment_statistics.htmlï¼‰

#### 3.4.1 ç»Ÿè®¡ç»´åº¦
- **æŒ‰é¡¹ç›®ç»Ÿè®¡**ï¼šå„é¡¹ç›®çš„å›æ¬¾é‡‘é¢ã€å›æ¬¾å®Œæˆç‡
- **æŒ‰æ—¶é—´ç»Ÿè®¡**ï¼šæœˆåº¦å›æ¬¾è¶‹åŠ¿ã€å¹´åº¦å›æ¬¾å¯¹æ¯”
- **æŒ‰çŠ¶æ€ç»Ÿè®¡**ï¼šå„çŠ¶æ€çš„å›æ¬¾è®°å½•æ•°é‡å’Œé‡‘é¢
- **æŒ‰ä»˜æ¬¾æ–¹ç»Ÿè®¡**ï¼šå„ä»˜æ¬¾æ–¹çš„å›æ¬¾æƒ…å†µ

#### 3.4.2 å›¾è¡¨å±•ç¤º
- å›æ¬¾è¶‹åŠ¿æŠ˜çº¿å›¾ï¼ˆæŒ‰æœˆä»½ï¼‰
- å›æ¬¾çŠ¶æ€é¥¼å›¾
- é¡¹ç›®å›æ¬¾å®Œæˆç‡æŸ±çŠ¶å›¾

---

## å››ã€æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 4.1 ç›®å½•ç»“æ„

```
backend/apps/financial_management/
â”œâ”€â”€ models.py          # æ·»åŠ  Payment æ¨¡å‹
â”œâ”€â”€ admin.py           # æ·»åŠ  PaymentAdmin é…ç½®
â”œâ”€â”€ forms.py           # æ·»åŠ  PaymentForm
â”œâ”€â”€ views_pages.py     # æ·»åŠ è§†å›¾å‡½æ•°
â”œâ”€â”€ urls.py            # æ·»åŠ  URL è·¯ç”±
â””â”€â”€ templates/financial_management/
    â”œâ”€â”€ payment_list.html          # åˆ—è¡¨é¡µ
    â”œâ”€â”€ payment_detail.html        # è¯¦æƒ…é¡µ
    â”œâ”€â”€ payment_form.html          # åˆ›å»º/ç¼–è¾‘è¡¨å•
    â””â”€â”€ payment_statistics.html    # ç»Ÿè®¡æŠ¥è¡¨é¡µ
```

### 4.2 URL è·¯ç”±è®¾è®¡

```python
# financial_management/urls.py
urlpatterns = [
    # ... ç°æœ‰è·¯ç”±
    
    # å›æ¬¾ç®¡ç†
    path("payments/", views_pages.payment_management, name="payment_management"),
    path("payments/create/", views_pages.payment_create, name="payment_create"),
    path("payments/<int:payment_id>/", views_pages.payment_detail, name="payment_detail"),
    path("payments/<int:payment_id>/edit/", views_pages.payment_update, name="payment_update"),
    path("payments/<int:payment_id>/delete/", views_pages.payment_delete, name="payment_delete"),
    path("payments/statistics/", views_pages.payment_statistics, name="payment_statistics"),
]
```

### 4.3 è§†å›¾å‡½æ•°è®¾è®¡

#### 4.3.1 payment_managementï¼ˆåˆ—è¡¨é¡µï¼‰
- æƒé™æ£€æŸ¥ï¼š`financial_management.payment.view`
- åŠŸèƒ½ï¼šåˆ†é¡µã€ç­›é€‰ã€æœç´¢ã€ç»Ÿè®¡

#### 4.3.2 payment_createï¼ˆåˆ›å»ºï¼‰
- æƒé™æ£€æŸ¥ï¼š`financial_management.payment.create`
- åŠŸèƒ½ï¼šè¡¨å•éªŒè¯ã€è‡ªåŠ¨ç”Ÿæˆå›æ¬¾å•å·ã€æ›´æ–°å…³è”å›æ¬¾è®¡åˆ’

#### 4.3.3 payment_updateï¼ˆç¼–è¾‘ï¼‰
- æƒé™æ£€æŸ¥ï¼š`financial_management.payment.manage`
- åŠŸèƒ½ï¼šè¡¨å•éªŒè¯ã€æ›´æ–°å…³è”å›æ¬¾è®¡åˆ’

#### 4.3.4 payment_detailï¼ˆè¯¦æƒ…ï¼‰
- æƒé™æ£€æŸ¥ï¼š`financial_management.payment.view`
- åŠŸèƒ½ï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯

#### 4.3.5 payment_deleteï¼ˆåˆ é™¤ï¼‰
- æƒé™æ£€æŸ¥ï¼š`financial_management.payment.delete`
- åŠŸèƒ½ï¼šåˆ é™¤å›æ¬¾è®°å½•ã€å›æ»šå…³è”å›æ¬¾è®¡åˆ’çš„çŠ¶æ€

#### 4.3.6 payment_statisticsï¼ˆç»Ÿè®¡ï¼‰
- æƒé™æ£€æŸ¥ï¼š`financial_management.payment.view`
- åŠŸèƒ½ï¼šç»Ÿè®¡æ•°æ®ã€å›¾è¡¨å±•ç¤º

### 4.4 æƒé™å®šä¹‰

```python
# system_management/management/commands/seed_permissions.py
{
    "code": "financial_management.payment.view",
    "module": "financial_management",
    "action": "payment.view",
    "name": "è´¢åŠ¡ç®¡ç†-å›æ¬¾ç®¡ç†-æŸ¥çœ‹",
    "description": "æŸ¥çœ‹å›æ¬¾è®°å½•"
},
{
    "code": "financial_management.payment.create",
    "module": "financial_management",
    "action": "payment.create",
    "name": "è´¢åŠ¡ç®¡ç†-å›æ¬¾ç®¡ç†-åˆ›å»º",
    "description": "åˆ›å»ºå›æ¬¾è®°å½•"
},
{
    "code": "financial_management.payment.manage",
    "module": "financial_management",
    "action": "payment.manage",
    "name": "è´¢åŠ¡ç®¡ç†-å›æ¬¾ç®¡ç†-ç®¡ç†",
    "description": "ç¼–è¾‘å’Œå®¡æ ¸å›æ¬¾è®°å½•"
},
{
    "code": "financial_management.payment.delete",
    "module": "financial_management",
    "action": "payment.delete",
    "name": "è´¢åŠ¡ç®¡ç†-å›æ¬¾ç®¡ç†-åˆ é™¤",
    "description": "åˆ é™¤å›æ¬¾è®°å½•"
},
```

### 4.5 è¡¨å•è®¾è®¡ï¼ˆPaymentFormï¼‰

```python
class PaymentForm(forms.ModelForm):
    class Meta:
        model = Payment
        fields = [
            'project', 'payment_plan', 'payment_date', 'status',
            'planned_amount', 'actual_amount', 'payment_method',
            'payer_name', 'payer_account', 'payee_account', 'bank_name',
            'invoice', 'voucher', 'attachment', 'notes'
        ]
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        # æ ¹æ®é€‰æ‹©çš„é¡¹ç›®åŠ¨æ€åŠ è½½å›æ¬¾è®¡åˆ’
        # æ ¹æ®é¡¹ç›®åŠ è½½æœªå…³è”å›æ¬¾çš„å‘ç¥¨
        # æ ¹æ®é¡¹ç›®åŠ è½½å·²è¿‡è´¦çš„å‡­è¯
```

### 4.6 å‰ç«¯äº¤äº’åŠŸèƒ½

#### 4.6.1 åŠ¨æ€è¡¨å•è”åŠ¨
- é€‰æ‹©é¡¹ç›®åï¼Œè‡ªåŠ¨åŠ è½½è¯¥é¡¹ç›®çš„å›æ¬¾è®¡åˆ’åˆ—è¡¨
- é€‰æ‹©å›æ¬¾è®¡åˆ’åï¼Œè‡ªåŠ¨å¡«å……è®¡åˆ’é‡‘é¢
- é€‰æ‹©é¡¹ç›®åï¼Œè‡ªåŠ¨åŠ è½½è¯¥é¡¹ç›®çš„æœªå›æ¬¾å‘ç¥¨åˆ—è¡¨

#### 4.6.2 é‡‘é¢è‡ªåŠ¨è®¡ç®—
- æ ¹æ®å·²å›æ¬¾é‡‘é¢å’Œè®¡åˆ’é‡‘é¢ï¼Œè‡ªåŠ¨åˆ¤æ–­çŠ¶æ€
- å®æ—¶æ˜¾ç¤ºå›æ¬¾å®Œæˆè¿›åº¦

#### 4.6.3 æ—¥æœŸéªŒè¯
- å›æ¬¾æ—¥æœŸä¸èƒ½è¶…è¿‡ä»Šå¤©
- å¦‚æœå…³è”äº†å›æ¬¾è®¡åˆ’ï¼Œå›æ¬¾æ—¥æœŸå»ºè®®åœ¨è®¡åˆ’æ—¥æœŸé™„è¿‘

---

## äº”ã€å¼€å‘æ­¥éª¤

### 5.1 ç¬¬ä¸€é˜¶æ®µï¼šæ•°æ®æ¨¡å‹å’ŒåŸºç¡€é…ç½®
1. âœ… åœ¨ `models.py` ä¸­åˆ›å»º `Payment` æ¨¡å‹
2. âœ… åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶
3. âœ… è¿è¡Œè¿ç§»
4. âœ… åœ¨ `admin.py` ä¸­é…ç½® `PaymentAdmin`
5. âœ… åœ¨æƒé™ç³»ç»Ÿä¸­æ·»åŠ å›æ¬¾ç®¡ç†ç›¸å…³æƒé™

### 5.2 ç¬¬äºŒé˜¶æ®µï¼šè¡¨å•å’Œè§†å›¾
1. âœ… åœ¨ `forms.py` ä¸­åˆ›å»º `PaymentForm`
2. âœ… åœ¨ `views_pages.py` ä¸­åˆ›å»ºè§†å›¾å‡½æ•°
3. âœ… åœ¨ `urls.py` ä¸­æ·»åŠ  URL è·¯ç”±

### 5.3 ç¬¬ä¸‰é˜¶æ®µï¼šæ¨¡æ¿å¼€å‘
1. âœ… åˆ›å»º `payment_list.html`ï¼ˆåˆ—è¡¨é¡µï¼‰
2. âœ… åˆ›å»º `payment_detail.html`ï¼ˆè¯¦æƒ…é¡µï¼‰
3. âœ… åˆ›å»º `payment_form.html`ï¼ˆåˆ›å»º/ç¼–è¾‘è¡¨å•ï¼‰
4. âœ… åˆ›å»º `payment_statistics.html`ï¼ˆç»Ÿè®¡æŠ¥è¡¨é¡µï¼Œå¯é€‰ï¼‰

### 5.4 ç¬¬å››é˜¶æ®µï¼šä¸šåŠ¡é€»è¾‘å®Œå–„
1. âœ… å®ç°å›æ¬¾å•å·è‡ªåŠ¨ç”Ÿæˆ
2. âœ… å®ç°çŠ¶æ€è‡ªåŠ¨æ›´æ–°é€»è¾‘
3. âœ… å®ç°ä¸å›æ¬¾è®¡åˆ’çš„è”åŠ¨æ›´æ–°
4. âœ… å®ç°åˆ é™¤æ—¶çš„å›æ»šé€»è¾‘

### 5.5 ç¬¬äº”é˜¶æ®µï¼šå¯¼èˆªå’Œèœå•é›†æˆ
1. âœ… æ›´æ–°è´¢åŠ¡ç®¡ç†ä¸»é¡µï¼Œæ·»åŠ å›æ¬¾ç®¡ç†å…¥å£
2. âœ… æ›´æ–°é¦–é¡µå·¦ä¾§èœå•ï¼Œæ·»åŠ å›æ¬¾ç®¡ç†é“¾æ¥
3. âœ… æ·»åŠ é¡¶éƒ¨å¯¼èˆªèœå•é¡¹

---

## å…­ã€ç•Œé¢è®¾è®¡è§„èŒƒ

### 6.1 é£æ ¼ç»Ÿä¸€
- éµå¾ªç°æœ‰çš„è´¢åŠ¡ç®¡ç†æ¨¡å—ç•Œé¢é£æ ¼
- ä½¿ç”¨ç›¸åŒçš„é¢œè‰²ä¸»é¢˜å’Œç»„ä»¶æ ·å¼
- ä¿æŒä¸å…¶ä»–æ¨¡å—çš„ä¸€è‡´æ€§

### 6.2 å“åº”å¼è®¾è®¡
- æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯è®¿é—®
- ä½¿ç”¨ Bootstrap 5.3 ç»„ä»¶
- ä¼˜åŒ–ç§»åŠ¨ç«¯æ“ä½œä½“éªŒ

### 6.3 äº¤äº’ä¼˜åŒ–
- è¡¨å•å­—æ®µåˆ†ç»„æ¸…æ™°
- å¿…å¡«å­—æ®µæ˜ç¡®æ ‡è¯†
- é”™è¯¯æç¤ºå‹å¥½æ˜ç¡®
- æ“ä½œåé¦ˆåŠæ—¶

---

## ä¸ƒã€æµ‹è¯•è¦ç‚¹

### 7.1 åŠŸèƒ½æµ‹è¯•
- âœ… å›æ¬¾è®°å½•åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
- âœ… å…³è”é¡¹ç›®ã€å›æ¬¾è®¡åˆ’ã€å‘ç¥¨
- âœ… çŠ¶æ€è‡ªåŠ¨æ›´æ–°
- âœ… é‡‘é¢è®¡ç®—æ­£ç¡®æ€§
- âœ… æƒé™æ§åˆ¶

### 7.2 æ•°æ®å®Œæ•´æ€§æµ‹è¯•
- âœ… å…³è”æ•°æ®åˆ é™¤æ—¶çš„å¤„ç†
- âœ… å›æ¬¾è®¡åˆ’çš„è‡ªåŠ¨æ›´æ–°
- âœ… å‘ç¥¨å…³è”çŠ¶æ€çš„æ›´æ–°

### 7.3 è¾¹ç•Œæµ‹è¯•
- âœ… é‡‘é¢ä¸ºè´Ÿæ•°æˆ–é›¶çš„æƒ…å†µ
- âœ… å›æ¬¾é‡‘é¢è¶…è¿‡è®¡åˆ’é‡‘é¢çš„æƒ…å†µ
- âœ… æ—¥æœŸé€‰æ‹©è¾¹ç•Œæƒ…å†µ

---

## å…«ã€åç»­æ‰©å±•åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

### 8.1 å›æ¬¾æé†’
- å³å°†åˆ°æœŸçš„å›æ¬¾æé†’
- é€¾æœŸå›æ¬¾é¢„è­¦

### 8.2 å›æ¬¾å®¡æ‰¹æµç¨‹
- å›æ¬¾è®°å½•çš„å®¡æ‰¹æµç¨‹
- å¤šçº§å®¡æ ¸æ”¯æŒ

### 8.3 å›æ¬¾å¯¹è´¦
- ä¸é¡¹ç›®ç»“ç®—çš„å¯¹è´¦åŠŸèƒ½
- ä¸å‘ç¥¨çš„å¯¹è´¦åŠŸèƒ½

### 8.4 å›æ¬¾æŠ¥è¡¨å¯¼å‡º
- Excel å¯¼å‡ºåŠŸèƒ½
- PDF æŠ¥è¡¨ç”Ÿæˆ

---

## ä¹ã€é£é™©è¯„ä¼°

### 9.1 æ•°æ®ä¸€è‡´æ€§é£é™©
- **é£é™©**ï¼šå›æ¬¾è®°å½•ä¸å›æ¬¾è®¡åˆ’æ•°æ®ä¸ä¸€è‡´
- **åº”å¯¹**ï¼šä½¿ç”¨äº‹åŠ¡ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Œæ·»åŠ æ•°æ®æ ¡éªŒ

### 9.2 æƒé™æ§åˆ¶é£é™©
- **é£é™©**ï¼šæœªæˆæƒç”¨æˆ·è®¿é—®æ•æ„Ÿè´¢åŠ¡æ•°æ®
- **åº”å¯¹**ï¼šä¸¥æ ¼æƒé™æ§åˆ¶ï¼Œæ‰€æœ‰æ“ä½œéƒ½éœ€è¦æƒé™æ£€æŸ¥

### 9.3 æ€§èƒ½é£é™©
- **é£é™©**ï¼šå¤§é‡å›æ¬¾è®°å½•å¯¼è‡´åˆ—è¡¨é¡µåŠ è½½æ…¢
- **åº”å¯¹**ï¼šåˆ†é¡µåŠ è½½ï¼Œæ·»åŠ æ•°æ®åº“ç´¢å¼•ï¼Œä¼˜åŒ–æŸ¥è¯¢

---

## åã€æ—¶é—´ä¼°ç®—

- **æ•°æ®æ¨¡å‹å’Œé…ç½®**ï¼š1-2 å°æ—¶
- **è¡¨å•å’Œè§†å›¾å¼€å‘**ï¼š2-3 å°æ—¶
- **æ¨¡æ¿å¼€å‘**ï¼š3-4 å°æ—¶
- **ä¸šåŠ¡é€»è¾‘å®Œå–„**ï¼š2-3 å°æ—¶
- **æµ‹è¯•å’Œè°ƒè¯•**ï¼š1-2 å°æ—¶

**æ€»è®¡**ï¼š9-14 å°æ—¶

---

## åä¸€ã€ç¡®è®¤äº‹é¡¹

è¯·ç¡®è®¤ä»¥ä¸‹å†…å®¹ï¼š
1. âœ… æ•°æ®æ¨¡å‹è®¾è®¡æ˜¯å¦ç¬¦åˆä¸šåŠ¡éœ€æ±‚ï¼Ÿ
2. âœ… åŠŸèƒ½æ¨¡å—æ˜¯å¦å®Œæ•´ï¼Ÿ
3. âœ… ç•Œé¢è®¾è®¡æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼Ÿ
4. âœ… å¼€å‘æ­¥éª¤æ˜¯å¦åˆç†ï¼Ÿ
5. âœ… æ˜¯å¦éœ€è¦è°ƒæ•´ä»»ä½•åŠŸèƒ½æˆ–å­—æ®µï¼Ÿ

ç¡®è®¤åå³å¯å¼€å§‹å¼€å‘å·¥ä½œã€‚

